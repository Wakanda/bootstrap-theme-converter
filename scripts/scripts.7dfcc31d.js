"use strict";angular.module("themeBuilderApp",["ngResource","ngRoute","ngSanitize"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("themeBuilderApp").controller("MainCtrl",["$scope","$timeout","bootstrapSettings","$window",function(a,b,c,d){function e(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"}function f(b){b.stopPropagation(),b.preventDefault();var c=b.dataTransfer.files[0];if(console.log(c),c){var d=new FileReader;d.readAsText(c,"UTF-8"),d.onload=function(b){var d={};if("json"===c.name.split(".").pop())d=angular.fromJson(b.target.result),a.lessVars=d.vars,a.$apply(),console.log(d.vars);else if("less"===c.name.split(".").pop()){var e=b.target.result.toString().split("\n");angular.forEach(e,function(a){if("@"===a[0]){var b=a.split(":")[0],c=a.split(":")[1];c=c.replace(/^\s+/,""),c=c.split(";")[0],d[b]=c}}),a.lessVars=d,a.$apply(),console.log(d)}a.refresh(),console.log(a.lessVars)},d.onerror=function(){a.lessVars="error reading file"}}}a.themeDetails={name:"My Theme",author:"Grumpy Cat",repository:{type:"git",url:"Repo Url"},copyright:"GNU GPL v3, AGPL v3, Commercial",license:"MIT",engines:{wakanda:">=11"},studio:{label:"Wakanda Corporate",mobile:"false"},version:"1.0.0",loadDependencies:[{id:"",path:"THEMES_CUSTOM"}],hash:"91038c8630d0ca29ba43354e7b3a79322720d3d7"},a.$watch("themeDetails",function(b){a.secureName=b.name.toLowerCase().replace(/ /g,"_"),a.themeDetails.loadDependencies[0].id=a.secureName+"/"+a.secureName+".css"}),a.loadBasicVars=function(){c.get().$promise.then(function(b){a.lessVars=b.vars,a.refresh()})},a.loadBasicVars(),a.refresh=function(){b(function(){less.modifyVars(a.lessVars)},1e3)};var g=document.getElementById("drop_zone");g.addEventListener("dragover",e,!1),g.addEventListener("drop",f,!1),a.generateTheme=function(){if(angular.isUndefined(d.studio))var b=window.location.pathname.substring(1).replace("/","-");else if(angular.isDefined(d.studio))var b="slombard-Documents-Wakanda-Extensions-ThemeBuilder-dist-";if(a.resultedCss=document.getElementById("less:"+b+"styles-bootstrap-bootstrap").innerHTML,console.log(a.resultedCss),angular.isUndefined(d.studio)){var c=new JSZip,e=c.folder(a.secureName);e.file("package.json",angular.toJson(a.themeDetails)),e.file(a.secureName+".css",a.resultedCss);var f=c.generate({type:"blob"});saveAs(f,a.secureName+".zip")}else angular.isDefined(d.studio)&&(studio.extension.storage.setItem("themeName",a.secureName.toString()),studio.extension.storage.setItem("themeJson",angular.toJson(a.themeDetails).toString()),studio.extension.storage.setItem("themeCss",a.resultedCss.toString()),studio.sendCommand("ThemeBuilder.exportTheme"))}}]),angular.module("themeBuilderApp").service("bootstrapSettings",["$resource",function(a){return a("styles/bootstrap/config.json")}]);